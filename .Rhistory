abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 2)
# Chunk 4: trend_decimpose()
# decompose( dane_4plus_Wiadomosci_liczba_ts)
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"))
# acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
# pacf(dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
# Chunk 5: trend_recznie
library(forecast)
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) # argument "order" wskazuje jaki jaka jest dlugosc okresu szerego czasowego - tutaj 12 miesiecy
plot(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
# Chunk 6: trend_recznie_zestawieni
dane_4plus_Wiadomosci_liczba_ts_trend<-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T )
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(dane_4plus_Wiadomosci_liczba_ts_trend, lty=2, lwd=2, col="red") # trend
# Chunk 7: trend_recznie_sprawdzenie
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == dane_4plus_Wiadomosci_liczba_ts_trend
# Chunk 8
plot(dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend)
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_m<-matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-dane_4plus_Wiadomosci_liczba_ts_sezonowosc-mean( dane_4plus_Wiadomosci_liczba_ts_sezonowosc) # to jest najwazniejszy krok ->
dane_4plus_Wiadomosci_liczba_ts
length( dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc [1:length( dane_4plus_Wiadomosci_liczba_ts)]
frequency( dane_4plus_Wiadomosci_liczba_ts)
matrix( data = dane_4plus_Wiadomosci_liczba_ts_sezonowosc ,ncol =  frequency( dane_4plus_Wiadomosci_liczba_ts), nrow = 4, byrow = TRUE)
ts(matrix( data = dane_4plus_Wiadomosci_liczba_ts_sezonowosc ,ncol =  frequency( dane_4plus_Wiadomosci_liczba_ts), nrow = 4, byrow = TRUE))
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts
as.numeric(dane_4plus_Wiadomosci_liczba_ts)
tech<-as.numeric(dane_4plus_Wiadomosci_liczba_ts)
tech<-dane_4plus_Wiadomosci_liczba_ts_sezonowosc
tech
ts(matrix( data = dane_4plus_Wiadomosci_liczba_ts_sezonowosc ,ncol =  frequency( dane_4plus_Wiadomosci_liczba_ts), nrow = 4, byrow = TRUE))
ts( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,  start = c(2013,1), frequency = 12 )
tech<-dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts
ts( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,  start = c(2013,1), end =c(2016,6)  frequency = 12 )
ts( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,  start = c(2013,1), end =c(2016,6) , frequency = 12 )
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-ts( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,  start = c(2013,1), end =c(2016,6) , frequency = 12 )
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_sezonowosc==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
plot(dane_4plus_Wiadomosci_liczba_ts_sezonowosc, ylab="oglądalność" , main="sezonowość")
dane_4plus_Wiadomosci_liczba_ts_s.losowy<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend-dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_s.losowy
plot( dane_4plus_Wiadomosci_liczba_ts_s.losowy)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
dane_4plus_Wiadomosci_liczba_ts_s.losowy==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
?decompose
decompose()
?decompose()
?decompose
decompose
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
dane_4plus_Wiadomosci_liczba_ts_s.losowy
m
dane_4plus_Wiadomosci_liczba_ts_s.losowy==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
dane_4plus_Wiadomosci_liczba_ts_s.losowy-decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
dane_4plus_Wiadomosci_liczba_ts_s.losowy==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]] # brak zgodnosci wynika z niewielkiej niedokladnosci
plot( dane_4plus_Wiadomosci_liczba_ts_s.losowy)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend )
lines(dane_4plus_Wiadomosci_liczba_ts_sezonowosc )
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
lines(dane_4plus_Wiadomosci_liczba_ts_s.losowy)
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty=1)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty="d")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty="5")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty=5)
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type=5)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="o")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="h")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2)
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="h")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2)
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="h", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="h", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts_sezonowosc)
plot( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts))
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc)
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,"2013-01-01", "2012-12-31")
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,"2013-01", "2012-12")
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,"2013-01", "2013-12")
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,"2013.01", "2013.12")
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013.01, 2013.12)
time( dane_4plus_Wiadomosci_liczba_ts_sezonowosc)
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917)
plot( window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917)
plot( window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917))
plot( window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917), xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Sezonowość na przykładzie roku 2013")
plot( window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917), xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Sezonowość na \nprzykładzie roku 2013")
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Sezonowość na \nprzykładzie roku 2013")
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts))
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend )
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="h", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="c", lwd=2)
dane_4plus_Wiadomosci_liczba_ts_trend
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="p", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="h", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="s", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="o", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="l", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="o", lwd=2)
library( googlesheets)
library( ggplot2)
library( reshape2)
# Chunk 1
# setwd("C:/Users/Zbyszek/Desktop/WAS/TELEMETRIA")
library( googlesheets)
library( ggplot2)
library( reshape2)
klucz<-extract_key_from_url("https://docs.google.com/spreadsheets/d/1CwAWrns8CAgizOu4iAHIqb4ckCcDfY_8xPKYr7CAUs4/edit?usp=sharing")
skoroszyt<-gs_key(klucz, visibility = "private")
#############################
# Dane o grupie w wieku 4+
#############################
dane_4plus<-gs_read(skoroszyt, "4_plus")
dane_4plus<-as.data.frame(dane_4plus)
ndane_4plus <- melt(dane_4plus,id=c("miesiac") ) # w uzyciu paciek reshape2
ndane_4plus$variable<-as.character(ndane_4plus$variable)
colnames(ndane_4plus)<-c("miesiac", "program","ogladalnosc")
#############################
# Dane o grupie 16-49
#############################
dane_16_49<-gs_read(skoroszyt, "16-49")
dane_16_49<-as.data.frame(dane_16_49)
ndane_16_49 <- melt(dane_16_49,id=c("miesiac") )
ndane_16_49$variable<-as.character(ndane_16_49$variable)
colnames(ndane_16_49)<-c("miesiac", "program","ogladalnosc")
# Chunk 2
##############
## udzial w widowni
##############
png('TELEMETRIA_wykresy/4_plus_udzial.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(ndane_4plus[ grep("procent",ndane_4plus$program),], aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Odsetek widzów w grupie 4+")
dev.off()
##############
## liczebnosc widowni
##############
png('TELEMETRIA_wykresy/4_plus_liczba.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(ndane_4plus[ !(1:dim(ndane_4plus)[1]) %in% grep("procent", ndane_4plus$program),], aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Liczba widzów w grupie 4+")
dev.off()
##############
## ROZNICE - zmiany rok do roku i procentowe rok do roku
##############
rdane_4plus<-as.matrix(dane_4plus[, !(1:dim(dane_4plus)[2]) %in% grep("procent|miesiac", colnames(dane_4plus) )])
rdane_4plus<- data.frame(  diff( rdane_4plus ,lag = 12) / rdane_4plus[1:(dim( rdane_4plus )[1]-12) ,  ]      )
rdane_4plus$miesiac<-dane_4plus$miesiac[ (dim(dane_4plus)[1]-dim(rdane_4plus)[1]+1):dim(dane_4plus)[1]]
nrdane_4plus <- melt(rdane_4plus,id=c("miesiac") ) # zmiana postaci danych
nrdane_4plus$variable<-as.character(nrdane_4plus$variable)
colnames(nrdane_4plus)<-c("miesiac", "program","ogladalnosc")
##############
## wykres roznic
##############
png('TELEMETRIA_wykresy/4_plus_roznica.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(nrdane_4plus, aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
geom_hline(aes(yintercept=0))+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Procentowe różnice rok do roku w grupie widzów 4+")
dev.off()
# Chunk 3
library(timeSeries) # pakiet do analizy szeregow czasowych
dane_4plus$czas<-gsub("/","\\-",dane_4plus$miesiac)
# na liczebnosciach Wiadomosci
dane_4plus_Wiadomosci_liczba_ts<-ts( data = dane_4plus$Wiadomosci_TVP1, start = c(2013,1), frequency = 12)
cycle( dane_4plus_Wiadomosci_liczba_ts)
aggregate( dane_4plus_Wiadomosci_liczba_ts)
time( dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data", ylim=c( 0, max(dane_4plus_Wiadomosci_liczba_ts)))
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 2)
# Chunk 4: trend_decimpose()
# decompose( dane_4plus_Wiadomosci_liczba_ts)
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"))
# acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
# pacf(dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
# Chunk 5: trend_recznie
library(forecast)
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) # argument "order" wskazuje jaki jaka jest dlugosc okresu szerego czasowego - tutaj 12 miesiecy
plot(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
# Chunk 6: trend_recznie_zestawieni
dane_4plus_Wiadomosci_liczba_ts_trend<-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T )
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(dane_4plus_Wiadomosci_liczba_ts_trend, lty=2, lwd=2, col="red") # trend
# Chunk 7: trend_recznie_sprawdzenie
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == dane_4plus_Wiadomosci_liczba_ts_trend
# Chunk 8
plot(dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend)
# Chunk 9
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_m<-matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-dane_4plus_Wiadomosci_liczba_ts_sezonowosc-mean( dane_4plus_Wiadomosci_liczba_ts_sezonowosc) # to jest najwazniejszy krok -> przesuniecie sredniej sezonowosci do zera
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-ts( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,  start = c(2013,1), end =c(2016,6) , frequency = 12 )
dane_4plus_Wiadomosci_liczba_ts_sezonowosc==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
plot(dane_4plus_Wiadomosci_liczba_ts_sezonowosc, ylab="oglądalność" , main="sezonowość")
# Chunk 10
filtr<-is.na( ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))==FALSE
dane_4plus_Wiadomosci_liczba_ts_s.losowy<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend-dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_s.losowy==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]] # brak zgodnosci wynika z niewielkiej niedokladnosci
plot( dane_4plus_Wiadomosci_liczba_ts_s.losowy)
# Chunk 11
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="h", lwd=2)
# Chunk 12
plot( window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917), xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Sezonowość na \nprzykładzie roku 2013")
# Chunk 13
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="o", lwd=2)
# lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="h", lwd=2)
filter
?filter
x <- 1:100
filter(x, rep(1, 3))
rep(1, 3)
plot( dane_4plus_Wiadomosci_liczba_ts ,type="l")
plot( dane_4plus_Wiadomosci_liczba_ts ,type="l", ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts))
plot( dane_4plus_Wiadomosci_liczba_ts ,type="l", ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
a<-2
(2*a+1)
rep(1/(2*a+1),(2*a+1))
plot( dane_4plus_Wiadomosci_liczba_ts ,type="l", ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
# (2*a+1) - to jest podzielnik w sredniej ruchomej - dla sredniej z trzech obserwacji rowny 3 dla 5 obserwacji rowny 5 itd;  parametr "a"" decyduje o tym na ile okresow w przod i tyl siegamy srednia ruchoma; np. a=2 oznacza, ze idziemy 2 pomiary w przod i tyl - lacznie 5 obserwacji;
a<-2
dane_4plus_Wiadomosci_liczba_ts_filtrowanie1 <- filter(dane_4plus_Wiadomosci_liczba_ts, filter=rep(1/(2*a+1),(2*a+1)))
a<-4
dane_4plus_Wiadomosci_liczba_ts_filtrowanie2 <- filter(dane_4plus_Wiadomosci_liczba_ts, filter=rep(1/(2*a+1),(2*a+1)))
a<-
dane_4plus_Wiadomosci_liczba_ts_filtrowanie3 <- filter(dane_4plus_Wiadomosci_liczba_ts, filter=rep(1/(2*a+1),(2*a+1)))
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie1,col="red")
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie2,col="purple")
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie3,col="blue")
plot( dane_4plus_Wiadomosci_liczba_ts ,type="l", ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie1,col="red")
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie2,col="green")
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie3,col="blue")
a<-2
dane_4plus_Wiadomosci_liczba_ts_filtrowanie1 <- filter(dane_4plus_Wiadomosci_liczba_ts, filter=rep(1/(2*a+1),(2*a+1)))
a<-4
dane_4plus_Wiadomosci_liczba_ts_filtrowanie2 <- filter(dane_4plus_Wiadomosci_liczba_ts, filter=rep(1/(2*a+1),(2*a+1)))
a<-6
dane_4plus_Wiadomosci_liczba_ts_filtrowanie3 <- filter(dane_4plus_Wiadomosci_liczba_ts, filter=rep(1/(2*a+1),(2*a+1)))
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie1,col="red")
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie2,col="green")
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie3,col="blue")
plot( dane_4plus_Wiadomosci_liczba_ts ,type="l", ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), lwd=2)
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie1,col="red", lwd=2)
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie2,col="green", lwd=2)
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie3,col="blue", lwd=2)
a<-5
dane_4plus_Wiadomosci_liczba_ts_filtrowanie3 <- filter(dane_4plus_Wiadomosci_liczba_ts, filter=rep(1/(2*a+1),(2*a+1)))
lines(dane_4plus_Wiadomosci_liczba_ts_filtrowanie3,col="blue", lwd=2)
plot( window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917), xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Sezonowość na \nprzykładzie roku 2013")
plot( dane_4plus_Wiadomosci_liczba_ts_s.losowy)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
time(dane_4plus_Wiadomosci_liczba_ts)
lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts)
)
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts) ),col="red", lwd=2)
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts) )$fit,col="red", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts) )$fit,col="red", lwd=2)
lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts) )$fit
dane_4plus_Wiadomosci_liczba_ts
numeric(length(dane_4plus_Wiadomosci_liczba_ts))
length(dane_4plus_Wiadomosci_liczba_ts)
(1:length(dane_4plus_Wiadomosci_liczba_ts))
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lm(dane_4plus_Wiadomosci_liczba_ts~(1:length(dane_4plus_Wiadomosci_liczba_ts)) )
(1:length(dane_4plus_Wiadomosci_liczba_ts))
dane_4plus_Wiadomosci_liczba_ts
lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts) )
lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts) )
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts) )$fit,col="red", lwd=2)
lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts) )$fit
dane_4plus_Wiadomosci_liczba_ts
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts) )$fit, lwd=2)
lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts)2 )$fit
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts)+10 )$fit, lwd=2)
lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit
lines(time(dane_4plus_Wiadomosci_liczba_ts), lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2)
plot( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2)
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2)
lines( rep( dane_4plus_Wiadomosci_liczba_ts[1] ,length( dane_4plus_Wiadomosci_liczba_ts)), lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( rep( dane_4plus_Wiadomosci_liczba_ts[1] ,length( dane_4plus_Wiadomosci_liczba_ts)), lwd=2)
rep( dane_4plus_Wiadomosci_liczba_ts[1] ,length( dane_4plus_Wiadomosci_liczba_ts))
plot( 1:10, 1:10)
lines( 2)
lines( 1:10)
plot( 1:10, 1:10)
lines( 1:10, col="red")
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2)
lines( rep( dane_4plus_Wiadomosci_liczba_ts[1] ,length( dane_4plus_Wiadomosci_liczba_ts)), lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2)
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2,  ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2,  ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2,  ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2,  ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2,  ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
dane_4plus_Wiadomosci_liczba_ts
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
abline( v=4325810)
abline( v=4325810, co="red")
abline( v=4325810, col="red")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
abline( v=4325810, col="red")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
abline( v=4325810, col="red")
abline( v=3670247, col="red")
abline( v=3670247, col="red")
abline( v=3670247, col="red")
dane_4plus_Wiadomosci_liczba_ts
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
abline( v=3670247, col="red")
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="o", lwd=2)
dane_4plus_Wiadomosci_liczba_ts_trend
abline(v=3630659)
abline(h=3630659)
time(dane_4plus_Wiadomosci_liczba_ts)
abline(h=2013.083)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
abline(h=2013.083)
abline(v=2013.083)
lines( 1:10, col="red")
lines( lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2,  ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( rep( dane_4plus_Wiadomosci_liczba_ts[1] ,length( dane_4plus_Wiadomosci_liczba_ts)), lwd=2)
rep( dane_4plus_Wiadomosci_liczba_ts[1] ,length( dane_4plus_Wiadomosci_liczba_ts))
points( rep( dane_4plus_Wiadomosci_liczba_ts[1] ,length( dane_4plus_Wiadomosci_liczba_ts)), lwd=2)
rep( dane_4plus_Wiadomosci_liczba_ts[1] ,length( dane_4plus_Wiadomosci_liczba_ts))
points( rep( dane_4plus_Wiadomosci_liczba_ts[1] ,length( dane_4plus_Wiadomosci_liczba_ts)))
points(time(dane_4plus_Wiadomosci_liczba_ts),  rep( dane_4plus_Wiadomosci_liczba_ts[1] ,length( dane_4plus_Wiadomosci_liczba_ts)))
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(time(dane_4plus_Wiadomosci_liczba_ts),  lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2)
time(dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( as.numeris( time(dane_4plus_Wiadomosci_liczba_ts)),  lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)),  lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)),  lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2, lty="b")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)),  lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2, lty="h")
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)),  lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2, lty=1)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)),  lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2, lty=2)
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)),  lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=2, lty=2, col="red")
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="o", lwd=2)
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="navyblue", type="o", lwd=2)
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)),  lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=3, lty=2, col="red")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)),  lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$fit, lwd=3, lty=2, col="red")
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="navyblue", type="o", lwd=2)
lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts))$coefficients
summary(lm(dane_4plus_Wiadomosci_liczba_ts~time(dane_4plus_Wiadomosci_liczba_ts)))
dane_4plus_Wiadomosci_liczba_ts
time(dane_4plus_Wiadomosci_liczba_ts)
184743*(1/12)
round(184743*(1/12))
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
czas<-time(dane_4plus_Wiadomosci_liczba_ts)
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)),  lm(dane_4plus_Wiadomosci_liczba_ts~czas+sin(2*pi*czas)+cos(2*pi*czas) )$fit, lwd=3, lty=2, col="red")
summary( lm(dane_4plus_Wiadomosci_liczba_ts~czas+sin(2*pi*czas)+cos(2*pi*czas) ))
alfa=0.5
wykładniki=1:10
alfa=0.5
wykladniki=1:10
alfa*(1-alfa)^wykladniki
(1-alfa)
(1-alfa)^wykladniki
alfa
(1-alfa)^wykladniki
?timeSeries
HoltWinters( dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)), HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted,col="red")
HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted
HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)), HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted$xhat,col="red")
HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted
class(HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted)
HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted["xhat"]
HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted[,"xhat"]
lines( as.numeric( time(dane_4plus_Wiadomosci_liczba_ts)), HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted[,"xhat"],col="red")
HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted[,"xhat"]
dane_4plus_Wiadomosci_liczba_ts
HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted[,"xhat"]
as.numeric( time(dane_4plus_Wiadomosci_liczba_ts))
lines( HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted[,"xhat"],col="red")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted[,"xhat"],col="red")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted[,"xhat"],col="red", lty=2)
lines( HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted[,"xhat"],col="red", lty=2, lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$fitted[,"xhat"],col="red", lty=2, lwd=2)
HoltWinters( dane_4plus_Wiadomosci_liczba_ts)
summary( HoltWinters(dane_4plus_Wiadomosci_liczba_ts))
summary( HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$coefficients)
HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$coefficients
HoltWinters(dane_4plus_Wiadomosci_liczba_ts)$alpha
HoltWinters(dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
HoltWinters(dane_4plus_Wiadomosci_liczba_ts),n.ahead=12)
predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=3)
max(dane_4plus_Wiadomosci_liczba_ts)
czas
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=3)
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=3, lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=3, lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=3, lwd=1)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=3, lwd=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=3, lwd=4)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=3, lwd=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=2, lwd=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=1, lwd=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=4, lwd=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=5, lwd=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=6, lwd=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=7, lwd=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=2, lwd=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=3, lwd=3)
```{r}
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=4, lwd=3)
predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2025.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=48),col="navyblue", lty=4, lwd=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)), xlim=c(min(time( dane_4plus_Wiadomosci_liczba_ts)), 2017.917))
lines( predict( HoltWinters(dane_4plus_Wiadomosci_liczba_ts), n.ahead=12),col="navyblue", lty=4, lwd=3)
sim.ar<-arima.sim(list(ar=c(0.4,0.4)),n=1000)
sim.ma<-arima.sim(list(ma=c(0.6,-0.4)),n=1000)
sim.ar
sim.ma<-arima.sim(list(ma=c(0.6,-0.4)),n=1000)
par(mfrow=c(2,2))
acf(sim.ar,main="ACF of AR(2) process")
acf(sim.ma,main="ACF of MA(2) process")
pacf(sim.ar,main="PACF of AR(2) process")
pacf(sim.ma,main="PACF of MA(2) process")
data(LakeHuron)
fit<-arima(LakeHuron,order=c(1,0,1))
fit
LakeHuron
plot()
plot(LakeHuron)
par(mfrow=c(1,1))
data(LakeHuron)
plot(LakeHuron)
fit<-arima(LakeHuron,order=c(1,0,1))
plot(LakeHuron, xlim=c(0,LakeHuron))
plot(LakeHuron, xlim=c(0,max(LakeHuron)))
plot(LakeHuron, ylim=c(0,max(LakeHuron)))
fit<-arima(LakeHuron,order=c(1,0,1))
tsdiag(fit)
