aggregate( dane_4plus_Wiadomosci_liczba_ts)
time( dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data")
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 2)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data", ylim=x( 0, max(dane_4plus_Wiadomosci_liczba_ts)))
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data", ylim=( 0, max(dane_4plus_Wiadomosci_liczba_ts)))
max(dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data", ylim=c( 0, max(dane_4plus_Wiadomosci_liczba_ts)))
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 2)
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"))
library(forecast)
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) # argument "order" wskazuje jaki jaka jest dlugosc okresu szerego czasowego - tutaj 12 miesiecy
plot(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), lty=2, lwd=2, col="red") # trend
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
plot(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
colMeans( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]]
summary(decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive") )
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
dane_4plus_Wiadomosci_liczba_ts
colMeans( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, na.rm = T)
colMeans( dane_4plus_Wiadomosci_liczba_ts, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts
rep(dane_4plus_Wiadomosci_liczba_ts_sezonowosc,4)
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
dane_4plus_Wiadomosci_liczba_ts_detrend
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
plot(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
lines( dane_4plus_Wiadomosci_liczba_ts_detrend, col="red")
t(matrix(data = dane_4plus_Wiadomosci_liczba_ts_detrend, nrow = 4))
dane_4plus_Wiadomosci_liczba_ts_m<-t(matrix(data = dane_4plus_Wiadomosci_liczba_ts_detrend, nrow = 12))
matrix(data = dane_4plus_Wiadomosci_liczba_ts_detrend, nrow = 4)
dane_4plus_Wiadomosci_liczba_ts_m<-t(matrix(data = dane_4plus_Wiadomosci_liczba_ts_detrend, nrow = 3))
dane_4plus_Wiadomosci_liczba_ts_m
matrix(data = dane_4plus_Wiadomosci_liczba_ts_detrend, nrow = 3)
dane_4plus_Wiadomosci_liczba_ts_detrend
dane_4plus_Wiadomosci_liczba_ts_detrend
dane_4plus_Wiadomosci_liczba_ts_detrend
install.packages("fpp")
library(fpp)
data(ausbeer)
timeserie_beer = tail(head(ausbeer, 17*4+2),17*4-4)
plot(as.ts(timeserie_beer))
trend_beer = ma(timeserie_beer, order = 4, centre = T)
trend_beer
plot(as.ts(timeserie_beer))
plot(as.ts(timeserie_beer))
plot(as.ts(timeserie_beer))
timeserie_beer
plot(as.ts(timeserie_beer))
trend_beer = ma(timeserie_beer, order = 4, centre = T)
plot(as.ts(timeserie_beer))
lines(trend_beer)
plot(as.ts(trend_beer))
detrend_beer = timeserie_beer - trend_beer
detrend_beer
plot(as.ts(detrend_beer))
m_beer = t(matrix(data = detrend_beer, nrow = 4))
m_beer
m_beer = t(matrix(data = detrend_beer, nrow = 4))
colMeans(m_beer, na.rm = T)
as.ts(rep(seasonal_beer,16))
seasonal_beer = colMeans(m_beer, na.rm = T)
as.ts(rep(seasonal_beer,16))
seasonal_beer
plot(as.ts(rep(seasonal_beer,16)))
plot( dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_detrend
matrix(data = dane_4plus_Wiadomosci_liczba_ts_detrend, ncol = 12)
dane_4plus_Wiadomosci_liczba_ts_detrend
as.numeric(dane_4plus_Wiadomosci_liczba_ts_detrend)
matrix(data = as.numeric(dane_4plus_Wiadomosci_liczba_ts_detrend), ncol = 12)
as.numeric(dane_4plus_Wiadomosci_liczba_ts_detrend)
matrix(data = as.numeric(dane_4plus_Wiadomosci_liczba_ts_detrend), ncol = 12, nrow = 4)
dane_4plus_Wiadomosci_liczba_ts_detrend
seasonal_beer
m_beer
timeserie_beer
dane_4plus_Wiadomosci_liczba_ts
dane_4plus_Wiadomosci_liczba_ts_detrend
as.numeric(dane_4plus_Wiadomosci_liczba_ts_detrend)
dane_4plus_Wiadomosci_liczba_ts_detrend
dane_4plus_Wiadomosci_liczba_ts
time(dane_4plus_Wiadomosci_liczba_ts )
summary(dane_4plus_Wiadomosci_liczba_ts )
cycle( dane_4plus_Wiadomosci_liczba_ts)
aggregate( dane_4plus_Wiadomosci_liczba_ts)
time( dane_4plus_Wiadomosci_liczba_ts)
dim( dane_4plus_Wiadomosci_liczba_ts)
attributes( dane_4plus_Wiadomosci_liczba_ts)
attr( dane_4plus_Wiadomosci_liczba_ts)
names( dane_4plus_Wiadomosci_liczba_ts)
colnames( dane_4plus_Wiadomosci_liczba_ts)
rownames( dane_4plus_Wiadomosci_liczba_ts)
max( dane_4plus_Wiadomosci_liczba_ts)
summary(dane_4plus_Wiadomosci_liczba_ts)
cycle(dane_4plus_Wiadomosci_liczba_ts)
names( cycle(dane_4plus_Wiadomosci_liczba_ts))
aggregate(dane_4plus_Wiadomosci_liczba_ts)
summary(dane_4plus_Wiadomosci_liczba_ts)
colStats (dane_4plus_Wiadomosci_liczba_ts)
colStats (dane_4plus_Wiadomosci_liczba_ts, mean)
units (dane_4plus_Wiadomosci_liczba_ts, mean)
units (dane_4plus_Wiadomosci_liczba_ts)
frequency (dane_4plus_Wiadomosci_liczba_ts)
length( dane_4plus_Wiadomosci_liczba_ts)
frequency (dane_4plus_Wiadomosci_liczba_ts) - length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
brakujace_miesiace<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
brakujace_miesiace
brakujace_miesiace
rm( brakujace_miesiace)
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts
rep(NA, liczba_brak_miesiecy)
c(dane_4plus_Wiadomosci_liczba_ts, rep(NA, liczba_brak_miesiecy) )
matrix(data = c(dane_4plus_Wiadomosci_liczba_ts, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4)
matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4)
dane_4plus_Wiadomosci_liczba_ts_detrend
rep(NA, liczba_brak_miesiecy)
c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) )
matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
dane_4plus_Wiadomosci_liczba_ts_m<-matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts_seasonal<-colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts_seasonal
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
dane_4plus_Wiadomosci_liczba_ts_m<-matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
dane_4plus_Wiadomosci_liczba_ts_seasonal<-colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
dane_4plus_Wiadomosci_liczba_ts
dane_4plus_Wiadomosci_liczba_ts_seasonal
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12, , centre = T ), lty=2, lwd=2, col="red") # trend
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12, , centre = T ), lty=2, lwd=2, col="red") # trend
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T ), lty=2, lwd=2, col="red") # trend
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T ), lty=2, lwd=2, col="red") # trend
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T )
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
dane_4plus_Wiadomosci_liczba_ts_detrend
m_beer
seasonal_beer
as.ts(rep(seasonal_beer,16))
decompose( timeserie_beer, type ="additive")[["seasonal"]]
data(ausbeer)
timeserie_beer = tail(head(ausbeer, 17*4+2),17*4-4)
plot(as.ts(timeserie_beer))
trend_beer = ma(timeserie_beer, order = 4, centre = T)
plot(as.ts(timeserie_beer))
lines(trend_beer)
plot(as.ts(trend_beer))
detrend_beer = timeserie_beer - trend_beer
plot(as.ts(detrend_beer))
m_beer = t(matrix(data = detrend_beer, nrow = 4))
seasonal_beer = colMeans(m_beer, na.rm = T)
plot(as.ts(rep(seasonal_beer,16)))
decompose( timeserie_beer, type ="additive")[["seasonal"]]
timeserie_beer
decompose(as.ts( timeserie_beer), type ="additive")[["seasonal"]]
timeserie_beer = tail(head(ausbeer, 17*4+2),17*4-4)
timeserie_beer
plot(as.ts(timeserie_beer))
as.ts(timeserie_beer)
as.ts(timeserie_beer)
decompose(as.ts(timeserie_beer), type ="additive")[["seasonal"]]
dane_4plus_Wiadomosci_liczba_ts
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]]
dane_4plus_Wiadomosci_liczba_ts
dane_4plus_Wiadomosci_liczba_ts_detrend
dane_4plus_Wiadomosci_liczba_ts
dane_4plus_Wiadomosci_liczba_ts[ is.na( dane_4plus_Wiadomosci_liczba_ts)]
is.na( dane_4plus_Wiadomosci_liczba_ts_detrend)
dane_4plus_Wiadomosci_liczba_ts[ is.na( dane_4plus_Wiadomosci_liczba_ts_detrend)]
cbind( dane_4plus_Wiadomosci_liczba_ts_detrend, dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T )
dane_4plus_Wiadomosci_liczba_ts_trend<-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T )
dane_4plus_Wiadomosci_liczba_ts_trend
lines(dane_4plus_Wiadomosci_liczba_ts_trend, lty=2, lwd=2, col="red") # trend
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(dane_4plus_Wiadomosci_liczba_ts_trend, lty=2, lwd=2, col="red") # trend
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == dane_4plus_Wiadomosci_liczba_ts_trend
plot(dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend)
dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_trend[ is.na(dane_4plus_Wiadomosci_liczba_ts_trend)]
dane_4plus_Wiadomosci_liczba_ts_trend[ is.na(dane_4plus_Wiadomosci_liczba_ts_trend)]<-0
dane_4plus_Wiadomosci_liczba_ts_trend
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
liczba_brak_miesiecy
dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_detrend
matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
dane_4plus_Wiadomosci_liczba_ts_m<-matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
dane_4plus_Wiadomosci_liczba_ts_seasonal<-colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
dane_4plus_Wiadomosci_liczba_ts_seasonal
dane_4plus_Wiadomosci_liczba_ts_m
colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
detrend_beer
m_beer
seasonal_beer
decompose(as.ts(timeserie_beer), type ="additive")[["seasonal"]]
decompose(as.ts(timeserie_beer), type ="additive")[["seasonal"]]
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_trend<-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T )
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(dane_4plus_Wiadomosci_liczba_ts_trend, lty=2, lwd=2, col="red") # trend
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) # argument "order" wskazuje jaki jaka jest dlugosc okresu szerego czasowego - tutaj 12 miesiecy
plot(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
dane_4plus_Wiadomosci_liczba_ts_trend<-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T )
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(dane_4plus_Wiadomosci_liczba_ts_trend, lty=2, lwd=2, col="red") # trend
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == dane_4plus_Wiadomosci_liczba_ts_trend
plot(dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend)
dane_4plus_Wiadomosci_liczba_ts_trend<-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T )
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(dane_4plus_Wiadomosci_liczba_ts_trend, lty=2, lwd=2, col="red") # trend
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == dane_4plus_Wiadomosci_liczba_ts_trend
plot(dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend)
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]]
dane_4plus_Wiadomosci_liczba_ts_trend
decompose()
decompose
1L
?seq.int
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_detrend
f = frequency( dane_4plus_Wiadomosci_liczba_ts)
f
L =  length( dane_4plus_Wiadomosci_liczba_ts)
f = frequency( dane_4plus_Wiadomosci_liczba_ts)
okres<-L%/%f
okres
seq( 1, L, by=f)
L
seq( 1, L, by=f)-1L
figure<-numeric( f)
figure
f
1L:f
figure
as.numeric( f)
figure<-numeric( f)
figure
figure<-numeric( f)
indeks<-seq( 1, L, by=f)-1L
indeks
for ( i in 1L:f){
#mean( dane_4plus_Wiadomosci_liczba_ts_detrend[indeks+i ], na.rm = TRUE)
}
i
indeks+i
dane_4plus_Wiadomosci_liczba_ts_detrend
dane_4plus_Wiadomosci_liczba_ts_detrend[indeks+i ]
mean( dane_4plus_Wiadomosci_liczba_ts_detrend[indeks+i ], na.rm = TRUE)
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
for ( i in 1L:f){
figure[i]<-mean( dane_4plus_Wiadomosci_liczba_ts_detrend[indeks+i ], na.rm = TRUE)
}
figure
figure - mean(figure)
dane_4plus_Wiadomosci_liczba_ts_seasonal<-ts:colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_m<-matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
dane_4plus_Wiadomosci_liczba_ts_seasonal<-ts:colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts_m
figure <-figure - mean(figure) # to jest najwazniejszy krok -> przesuniecie
mean ( figure)
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_m<-matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
dane_4plus_Wiadomosci_liczba_ts_m
colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts_seasonal<-colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts_seasonal<-dane_4plus_Wiadomosci_liczba_ts_seasonal-mean( dane_4plus_Wiadomosci_liczba_ts_seasonal)
dane_4plus_Wiadomosci_liczba_ts_seasonal
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
dane_4plus_Wiadomosci_liczba_ts_seasonal
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-dane_4plus_Wiadomosci_liczba_ts_sezonowosc-mean( dane_4plus_Wiadomosci_liczba_ts_sezonowosc) # to jest najwazniejszy krok -> przesuniecie sredniej sezonowosci do zera
plot(dane_4plus_Wiadomosci_liczba_ts_sezonowosc, ylab="oglądalność" , main="sezonowość")
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts
!is.na(dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[!is.na(dane_4plus_Wiadomosci_liczba_ts)]
dane_4plus_Wiadomosci_liczba_ts<-dane_4plus_Wiadomosci_liczba_ts_sezonowosc
# Chunk 1
# setwd("C:/Users/Zbyszek/Desktop/WAS/TELEMETRIA")
library( googlesheets)
library( ggplot2)
library( reshape2)
klucz<-extract_key_from_url("https://docs.google.com/spreadsheets/d/1CwAWrns8CAgizOu4iAHIqb4ckCcDfY_8xPKYr7CAUs4/edit?usp=sharing")
skoroszyt<-gs_key(klucz, visibility = "private")
#############################
# Dane o grupie w wieku 4+
#############################
dane_4plus<-gs_read(skoroszyt, "4_plus")
dane_4plus<-as.data.frame(dane_4plus)
ndane_4plus <- melt(dane_4plus,id=c("miesiac") ) # w uzyciu paciek reshape2
ndane_4plus$variable<-as.character(ndane_4plus$variable)
colnames(ndane_4plus)<-c("miesiac", "program","ogladalnosc")
#############################
# Dane o grupie 16-49
#############################
dane_16_49<-gs_read(skoroszyt, "16-49")
dane_16_49<-as.data.frame(dane_16_49)
ndane_16_49 <- melt(dane_16_49,id=c("miesiac") )
ndane_16_49$variable<-as.character(ndane_16_49$variable)
colnames(ndane_16_49)<-c("miesiac", "program","ogladalnosc")
# Chunk 2
##############
## udzial w widowni
##############
png('TELEMETRIA_wykresy/4_plus_udzial.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(ndane_4plus[ grep("procent",ndane_4plus$program),], aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Odsetek widzów w grupie 4+")
dev.off()
##############
## liczebnosc widowni
##############
png('TELEMETRIA_wykresy/4_plus_liczba.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(ndane_4plus[ !(1:dim(ndane_4plus)[1]) %in% grep("procent", ndane_4plus$program),], aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Liczba widzów w grupie 4+")
dev.off()
##############
## ROZNICE - zmiany rok do roku i procentowe rok do roku
##############
rdane_4plus<-as.matrix(dane_4plus[, !(1:dim(dane_4plus)[2]) %in% grep("procent|miesiac", colnames(dane_4plus) )])
rdane_4plus<- data.frame(  diff( rdane_4plus ,lag = 12) / rdane_4plus[1:(dim( rdane_4plus )[1]-12) ,  ]      )
rdane_4plus$miesiac<-dane_4plus$miesiac[ (dim(dane_4plus)[1]-dim(rdane_4plus)[1]+1):dim(dane_4plus)[1]]
nrdane_4plus <- melt(rdane_4plus,id=c("miesiac") ) # zmiana postaci danych
nrdane_4plus$variable<-as.character(nrdane_4plus$variable)
colnames(nrdane_4plus)<-c("miesiac", "program","ogladalnosc")
##############
## wykres roznic
##############
png('TELEMETRIA_wykresy/4_plus_roznica.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(nrdane_4plus, aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
geom_hline(aes(yintercept=0))+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Procentowe różnice rok do roku w grupie widzów 4+")
dev.off()
# Chunk 3
library(timeSeries) # pakiet do analizy szeregow czasowych
dane_4plus$czas<-gsub("/","\\-",dane_4plus$miesiac)
# na liczebnosciach Wiadomosci
dane_4plus_Wiadomosci_liczba_ts<-ts( data = dane_4plus$Wiadomosci_TVP1, start = c(2013,1), frequency = 12)
cycle( dane_4plus_Wiadomosci_liczba_ts)
aggregate( dane_4plus_Wiadomosci_liczba_ts)
time( dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data", ylim=c( 0, max(dane_4plus_Wiadomosci_liczba_ts)))
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 2)
# Chunk 4: trend_decimpose()
# decompose( dane_4plus_Wiadomosci_liczba_ts)
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"))
# acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
# pacf(dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
# Chunk 5: trend_recznie
library(forecast)
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) # argument "order" wskazuje jaki jaka jest dlugosc okresu szerego czasowego - tutaj 12 miesiecy
plot(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
# Chunk 6: trend_recznie_zestawieni
dane_4plus_Wiadomosci_liczba_ts_trend<-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12,  centre = T )
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(dane_4plus_Wiadomosci_liczba_ts_trend, lty=2, lwd=2, col="red") # trend
# Chunk 7: trend_recznie_sprawdzenie
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == dane_4plus_Wiadomosci_liczba_ts_trend
# Chunk 8
plot(dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend)
liczba_brak_miesiecy<-frequency (dane_4plus_Wiadomosci_liczba_ts)-length( dane_4plus_Wiadomosci_liczba_ts)%%frequency (dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_detrend<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend
dane_4plus_Wiadomosci_liczba_ts_m<-matrix(data = c(dane_4plus_Wiadomosci_liczba_ts_detrend, rep(NA, liczba_brak_miesiecy) ), ncol = 12, nrow = 4, byrow = TRUE)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-colMeans(dane_4plus_Wiadomosci_liczba_ts_m, na.rm = T)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-dane_4plus_Wiadomosci_liczba_ts_sezonowosc-mean( dane_4plus_Wiadomosci_liczba_ts_sezonowosc) # to jest najwazniejszy krok ->
dane_4plus_Wiadomosci_liczba_ts
length( dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc [1:length( dane_4plus_Wiadomosci_liczba_ts)]
frequency( dane_4plus_Wiadomosci_liczba_ts)
matrix( data = dane_4plus_Wiadomosci_liczba_ts_sezonowosc ,ncol =  frequency( dane_4plus_Wiadomosci_liczba_ts), nrow = 4, byrow = TRUE)
ts(matrix( data = dane_4plus_Wiadomosci_liczba_ts_sezonowosc ,ncol =  frequency( dane_4plus_Wiadomosci_liczba_ts), nrow = 4, byrow = TRUE))
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts
as.numeric(dane_4plus_Wiadomosci_liczba_ts)
tech<-as.numeric(dane_4plus_Wiadomosci_liczba_ts)
tech<-dane_4plus_Wiadomosci_liczba_ts_sezonowosc
tech
ts(matrix( data = dane_4plus_Wiadomosci_liczba_ts_sezonowosc ,ncol =  frequency( dane_4plus_Wiadomosci_liczba_ts), nrow = 4, byrow = TRUE))
ts( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,  start = c(2013,1), frequency = 12 )
tech<-dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts
ts( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,  start = c(2013,1), end =c(2016,6)  frequency = 12 )
ts( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,  start = c(2013,1), end =c(2016,6) , frequency = 12 )
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-ts( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,  start = c(2013,1), end =c(2016,6) , frequency = 12 )
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_sezonowosc==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
plot(dane_4plus_Wiadomosci_liczba_ts_sezonowosc, ylab="oglądalność" , main="sezonowość")
dane_4plus_Wiadomosci_liczba_ts_s.losowy<-dane_4plus_Wiadomosci_liczba_ts-dane_4plus_Wiadomosci_liczba_ts_trend-dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_s.losowy
plot( dane_4plus_Wiadomosci_liczba_ts_s.losowy)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
dane_4plus_Wiadomosci_liczba_ts_s.losowy==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
?decompose
decompose()
?decompose()
?decompose
decompose
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
dane_4plus_Wiadomosci_liczba_ts_s.losowy
m
dane_4plus_Wiadomosci_liczba_ts_s.losowy==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
dane_4plus_Wiadomosci_liczba_ts_s.losowy-decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
dane_4plus_Wiadomosci_liczba_ts_s.losowy==decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]] # brak zgodnosci wynika z niewielkiej niedokladnosci
plot( dane_4plus_Wiadomosci_liczba_ts_s.losowy)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend )
lines(dane_4plus_Wiadomosci_liczba_ts_sezonowosc )
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
lines(dane_4plus_Wiadomosci_liczba_ts_s.losowy)
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty=1)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty=3)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty="d")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty="5")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", lty=5)
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type=5)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="o")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="h")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2)
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="h")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2)
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="h", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data", lwd=2, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend + dane_4plus_Wiadomosci_liczba_ts_sezonowosc + dane_4plus_Wiadomosci_liczba_ts_s.losowy , col="red", type="h", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts_sezonowosc)
plot( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts))
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc)
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,"2013-01-01", "2012-12-31")
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,"2013-01", "2012-12")
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,"2013-01", "2013-12")
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc,"2013.01", "2013.12")
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013.01, 2013.12)
time( dane_4plus_Wiadomosci_liczba_ts_sezonowosc)
window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917)
plot( window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917)
plot( window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917))
plot( window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917), xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Sezonowość na przykładzie roku 2013")
plot( window( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, 2013, 2013.917), xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Sezonowość na \nprzykładzie roku 2013")
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Sezonowość na \nprzykładzie roku 2013")
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts))
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend )
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="h", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="c", lwd=2)
dane_4plus_Wiadomosci_liczba_ts_trend
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="p", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="h", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="s", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="o", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="l", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, xlab="Miesiące", ylab="sezonowe zmiany oglądalności", main= "Trend",ylim=c(0, max(dane_4plus_Wiadomosci_liczba_ts)))
lines(dane_4plus_Wiadomosci_liczba_ts_trend,  col="red", type="o", lwd=2)
