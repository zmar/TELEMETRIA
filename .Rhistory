ndane_16_49$variable<-as.character(ndane_16_49$variable)
colnames(ndane_16_49)<-c("miesiac", "program","ogladalnosc")
library(timeSeries)
dane_4plus$czas<-gsub("/","\\-",dane_4plus$miesiac)
# na liczebnosciach Wiadomosci
dane_4plus_Wiadomosci_liczba_ts<-ts( data = dane_4plus$Wiadomosci_TVP1, start = c(2013,1), frequency = 12)
cycle( dane_4plus_Wiadomosci_liczba_ts)
aggregate( dane_4plus_Wiadomosci_liczba_ts)
time( dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts, col="blue")
points( dane_4plus_Wiadomosci_liczba_ts, col="red", pch = 19)
lag.plot(dane_4plus_Wiadomosci_liczba_ts, lags = 1, do.lines = FALSE, col="red", pch=19, diag.col = "blue")
dane_4plus_Wiadomosci_liczba_ts_ARIMA<-arima( dane_4plus_Wiadomosci_liczba_ts, order = c(1,0,0))
dane_4plus_Wiadomosci_liczba_ts_ARIMA
options(scipen=10)
plot( as.vector(dane_4plus_Wiadomosci_liczba_ts), as.vector(dane_4plus_Wiadomosci_liczba_ts_ARIMA$residuals) )
abline( h = 0, col="red")
plot( dane_4plus_Wiadomosci_liczba_ts, col="blue")
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ))
points( dane_4plus_Wiadomosci_liczba_ts, col="red", pch = 19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red")
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3")
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, col="blue")
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2)
points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
decompose( dane_4plus_Wiadomosci_liczba_ts)
decompose( dane_4plus_Wiadomosci_liczba_ts)
plot( decompose( dane_4plus_Wiadomosci_liczba_ts))
acf( dane_4plus_Wiadomosci_liczba_ts)
?acf
ddd<-acf( dane_4plus_Wiadomosci_liczba_ts)
ddd$acf
ddd$type
summary( ddd )
ddd$n.used
ddd$lag
ddd$series
ddd$snames
acf( dane_4plus_Wiadomosci_liczba_ts)
dane_4plus_Wiadomosci_liczba_ts
acf( dane_4plus_Wiadomosci_liczba_ts)
ddd<-acf( dane_4plus_Wiadomosci_liczba_ts)
ddd
?arima
acf( dane_4plus_Wiadomosci_liczba_ts)
pacf(dane_4plus_Wiadomosci_liczba_ts)
data(presidents)
plot( data(presidents)_
plot( data(presidents))
plot( presidents)
decompose( presidents)
decompose( presidents, na.action=na.pass)
ddd
acf( dane_4plus_Wiadomosci_liczba_ts)
acf( dane_4plus_Wiadomosci_liczba_ts, lag.max = 10)
acf( dane_4plus_Wiadomosci_liczba_ts, lag.max = 20)
acf( dane_4plus_Wiadomosci_liczba_ts, lag.max = 30)
acf( dane_4plus_Wiadomosci_liczba_ts, lag.max = 100)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,20) )
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,5) )
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,3) )
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,2) )
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,2) , lag.max = 30)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,100) , lag.max = 30)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,100) , lag.max = 100)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,20) , lag.max = 100)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,20) , lag.max = 1000)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,20) , lag.max = 100)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,5) , lag.max = 100)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 100)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 100)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 20)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 50)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
pacf(dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
# setwd("C:/Users/Zbyszek/Desktop/WAS/TELEMETRIA")
library( googlesheets)
library( ggplot2)
library( reshape2)
klucz<-extract_key_from_url("https://docs.google.com/spreadsheets/d/1CwAWrns8CAgizOu4iAHIqb4ckCcDfY_8xPKYr7CAUs4/edit?usp=sharing")
skoroszyt<-gs_key(klucz, visibility = "private")
#############################
# Dane o grupie w wieku 4+
#############################
dane_4plus<-gs_read(skoroszyt, "4_plus")
dane_4plus<-as.data.frame(dane_4plus)
ndane_4plus <- melt(dane_4plus,id=c("miesiac") ) # w uzyciu paciek reshape2
ndane_4plus$variable<-as.character(ndane_4plus$variable)
colnames(ndane_4plus)<-c("miesiac", "program","ogladalnosc")
#############################
# Dane o grupie 16-49
#############################
dane_16_49<-gs_read(skoroszyt, "16-49")
dane_16_49<-as.data.frame(dane_16_49)
ndane_16_49 <- melt(dane_16_49,id=c("miesiac") )
ndane_16_49$variable<-as.character(ndane_16_49$variable)
colnames(ndane_16_49)<-c("miesiac", "program","ogladalnosc")
##############
## udzial w widowni
##############
png('TELEMETRIA_wykresy/4_plus_udzial.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(ndane_4plus[ grep("procent",ndane_4plus$program),], aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Odsetek widzów w grupie 4+")
dev.off()
##############
## liczebnosc widowni
##############
png('TELEMETRIA_wykresy/4_plus_liczba.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(ndane_4plus[ !(1:dim(ndane_4plus)[1]) %in% grep("procent", ndane_4plus$program),], aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Liczba widzów w grupie 4+")
dev.off()
##############
## ROZNICE - zmiany rok do roku i procentowe rok do roku
##############
rdane_4plus<-as.matrix(dane_4plus[, !(1:dim(dane_4plus)[2]) %in% grep("procent|miesiac", colnames(dane_4plus) )])
rdane_4plus<- data.frame(  diff( rdane_4plus ,lag = 12) / rdane_4plus[1:(dim( rdane_4plus )[1]-12) ,  ]      )
rdane_4plus$miesiac<-dane_4plus$miesiac[ (dim(dane_4plus)[1]-dim(rdane_4plus)[1]+1):dim(dane_4plus)[1]]
nrdane_4plus <- melt(rdane_4plus,id=c("miesiac") ) # zmiana postaci danych
nrdane_4plus$variable<-as.character(nrdane_4plus$variable)
colnames(nrdane_4plus)<-c("miesiac", "program","ogladalnosc")
##############
## wykres roznic
##############
png('TELEMETRIA_wykresy/4_plus_roznica.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(nrdane_4plus, aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
geom_hline(aes(yintercept=0))+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Procentowe różnice rok do roku w grupie widzów 4+")
dev.off()
# Chunk 1
# setwd("C:/Users/Zbyszek/Desktop/WAS/TELEMETRIA")
library( googlesheets)
library( ggplot2)
library( reshape2)
klucz<-extract_key_from_url("https://docs.google.com/spreadsheets/d/1CwAWrns8CAgizOu4iAHIqb4ckCcDfY_8xPKYr7CAUs4/edit?usp=sharing")
skoroszyt<-gs_key(klucz, visibility = "private")
#############################
# Dane o grupie w wieku 4+
#############################
dane_4plus<-gs_read(skoroszyt, "4_plus")
dane_4plus<-as.data.frame(dane_4plus)
ndane_4plus <- melt(dane_4plus,id=c("miesiac") ) # w uzyciu paciek reshape2
ndane_4plus$variable<-as.character(ndane_4plus$variable)
colnames(ndane_4plus)<-c("miesiac", "program","ogladalnosc")
#############################
# Dane o grupie 16-49
#############################
dane_16_49<-gs_read(skoroszyt, "16-49")
dane_16_49<-as.data.frame(dane_16_49)
ndane_16_49 <- melt(dane_16_49,id=c("miesiac") )
ndane_16_49$variable<-as.character(ndane_16_49$variable)
colnames(ndane_16_49)<-c("miesiac", "program","ogladalnosc")
# Chunk 2
##############
## udzial w widowni
##############
png('TELEMETRIA_wykresy/4_plus_udzial.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(ndane_4plus[ grep("procent",ndane_4plus$program),], aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Odsetek widzów w grupie 4+")
dev.off()
##############
## liczebnosc widowni
##############
png('TELEMETRIA_wykresy/4_plus_liczba.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(ndane_4plus[ !(1:dim(ndane_4plus)[1]) %in% grep("procent", ndane_4plus$program),], aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Liczba widzów w grupie 4+")
dev.off()
##############
## ROZNICE - zmiany rok do roku i procentowe rok do roku
##############
rdane_4plus<-as.matrix(dane_4plus[, !(1:dim(dane_4plus)[2]) %in% grep("procent|miesiac", colnames(dane_4plus) )])
rdane_4plus<- data.frame(  diff( rdane_4plus ,lag = 12) / rdane_4plus[1:(dim( rdane_4plus )[1]-12) ,  ]      )
rdane_4plus$miesiac<-dane_4plus$miesiac[ (dim(dane_4plus)[1]-dim(rdane_4plus)[1]+1):dim(dane_4plus)[1]]
nrdane_4plus <- melt(rdane_4plus,id=c("miesiac") ) # zmiana postaci danych
nrdane_4plus$variable<-as.character(nrdane_4plus$variable)
colnames(nrdane_4plus)<-c("miesiac", "program","ogladalnosc")
##############
## wykres roznic
##############
png('TELEMETRIA_wykresy/4_plus_roznica.png',  res = 200, width = 20, height = 10, units = "cm") #bg = "white",
ggplot(nrdane_4plus, aes(x=miesiac , y=ogladalnosc, group=program, color=program))+
geom_line()+
geom_hline(aes(yintercept=0))+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = "Procentowe różnice rok do roku w grupie widzów 4+")
dev.off()
# Chunk 3
library(timeSeries) # pakiet do analizy szeregow czasowych
dane_4plus$czas<-gsub("/","\\-",dane_4plus$miesiac)
# na liczebnosciach Wiadomosci
dane_4plus_Wiadomosci_liczba_ts<-ts( data = dane_4plus$Wiadomosci_TVP1, start = c(2013,1), frequency = 12)
cycle( dane_4plus_Wiadomosci_liczba_ts)
aggregate( dane_4plus_Wiadomosci_liczba_ts)
time( dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2)
points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2)
decompose( dane_4plus_Wiadomosci_liczba_ts)
plot( decompose( dane_4plus_Wiadomosci_liczba_ts))
acf( dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
pacf(dane_4plus_Wiadomosci_liczba_ts, xlim=c(1,4) , lag.max = 60)
# Chunk 4
lag.plot(dane_4plus_Wiadomosci_liczba_ts, lags = 1, do.lines = FALSE, col="red", pch=19, diag.col = "blue")
# Chunk 5
dane_4plus_Wiadomosci_liczba_ts_ARIMA<-arima( dane_4plus_Wiadomosci_liczba_ts, order = c(1,0,0))
dane_4plus$czas<-gsub("/","\\-",dane_4plus$miesiac)
# na liczebnosciach Wiadomosci
dane_4plus_Wiadomosci_liczba_ts<-ts( data = dane_4plus$Wiadomosci_TVP1, start = c(2013,1), frequency = 12)
cycle( dane_4plus_Wiadomosci_liczba_ts)
aggregate( dane_4plus_Wiadomosci_liczba_ts)
time( dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2)
points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2)
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów 'Wiadomości' TVP")
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów/n'Wiadomości' TVP")
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP")
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów")
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="czas")
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data")
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data")
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty=b)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty="b")
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, type="b")
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 3)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 3)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data")
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data")
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 3)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 1)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data")
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 2)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data")
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 4)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data")
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 3)
plot( dane_4plus_Wiadomosci_liczba_ts, lwd=2, main="Szacowana liczba widzów\n'Wiadomości' TVP", ylab="liczba widzów", xlab="data")
# points( dane_4plus_Wiadomosci_liczba_ts, pch=19)
abline( reg=lm( dane_4plus_Wiadomosci_liczba_ts~time( dane_4plus_Wiadomosci_liczba_ts) ), col="red3", lwd=2, lty = 2)
decompose( dane_4plus_Wiadomosci_liczba_ts)
plot( decompose( dane_4plus_Wiadomosci_liczba_ts))
plot( decompose( dane_4plus_Wiadomosci_liczba_ts))
plot( decompose( dane_4plus_Wiadomosci_liczba_ts), ylab="dskadl" )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"), ylab="dskadl" )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="multiplicative"), ylab="dskadl" )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"), ylab="dskadl" )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="multiplicative"), ylab="dskadl" )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"), ylab="dskadl" )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="multiplicative"), ylab="dskadl" )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"), ylab="dskadl" )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="multiplicative"), ylab="dskadl" )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"))
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="multiplicative") )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"))
ma( dane_4plus_Wiadomosci_liczba_ts)
library(forecast)
install.packages("forecast")
ma( dane_4plus_Wiadomosci_liczba_ts)
a
library(forecast)
ma( dane_4plus_Wiadomosci_liczba_ts)
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
plot(dane_4plus_Wiadomosci_liczba_ts)
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
plot(dane_4plus_Wiadomosci_liczba_ts)
plot(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"))
plot(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
summary(decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"))
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"]
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"]==ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
(decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"])==(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
as.numeric(decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"])==as.numeric(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
as.numeric(decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"])
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"]
class(decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"])
class(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
unlist(decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"])==
unlist(decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"])
unlist(decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"])==(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) # argument "order" wskazuje jaki jaka jest dlugosc okresu szerego czasowego - tutaj 12 miesiecy
plot(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), lty=2)
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), lty=2)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), lty=2, lwd=2)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), lty=2, lwd=2, col="red")
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), lty=2, lwd=2, col="red")
plot(dane_4plus_Wiadomosci_liczba_ts)
lines(ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), lty=2, lwd=2, col="red")
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"]
unlist( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"])
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]]
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
plot(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 4))
t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12))
dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"))
t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12))
matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12)
t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12))
dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12))
colMeans(t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12)), na.rm = T)
plot(as.ts(rep(colMeans(t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12)), na.rm = T),4)))
plot(as.ts(rep(colMeans(t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12)), na.rm = T),4))  )
plot(as.ts(rep(colMeans(t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12)), na.rm = T),4)), ylab="oglądalność"  )
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12))
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-colMeans( dane_4plus_Wiadomosci_liczba_ts_sezonowosc, na.rm = T)
plot(dane_4plus_Wiadomosci_liczba_ts_sezonowosc, ylab="oglądalność"  )
dane_4plus_Wiadomosci_liczba_ts_sezonowosc<-as.ts(rep(dane_4plus_Wiadomosci_liczba_ts_sezonowosc,4)) # rozciaganie wynikow dla 12 miesiecy na caly badany okres
plot(dane_4plus_Wiadomosci_liczba_ts_sezonowosc, ylab="oglądalność"  )
plot(dane_4plus_Wiadomosci_liczba_ts_sezonowosc, ylab="oglądalność" , main="sezonowość")
dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )-dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
is.na( ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))
filtr<-is.na( ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ))==FALSE
dane_4plus_Wiadomosci_liczba_ts[filtr]-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]-dane_4plus_Wiadomosci_liczba_ts_sezonowosc[ filtr]
plot(as.ts(dane_4plus_Wiadomosci_liczba_ts[filtr]-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]-dane_4plus_Wiadomosci_liczba_ts_sezonowosc[ filtr]))
dane_4plus_Wiadomosci_liczba_ts_random<-as.ts(dane_4plus_Wiadomosci_liczba_ts[filtr]-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]-dane_4plus_Wiadomosci_liczba_ts_sezonowosc[ filtr])
plot( dane_4plus_Wiadomosci_liczba_ts_random)
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts_random
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc+
dane_4plus_Wiadomosci_liczba_ts_random
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr]
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr]
plot(
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr]
)
plot(
as.ts(
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr]
)
)
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]] == ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
plot( decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive"))
plot( dane_4plus_Wiadomosci_liczba_ts_random)
plot(
as.ts(
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr]
)
)
xlab="liczba widzów"
plot(
as.ts(
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr]
),
xlab="liczba widzów"
)
plot(
as.ts(
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr]
),
ylab="liczba widzów"
)
plot(
as.ts(
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr]
),
ylab="liczba widzów",
xlab="data"
)
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
dane_4plus_Wiadomosci_liczba_ts
dane_4plus_Wiadomosci_liczba_ts[filtr]
ts(
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr],
start = c(2013,7), frequency = 12
)
plot(
ts(
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr],
start = c(2013,7), frequency = 12
),
ylab="liczba widzów",
xlab="data"
)
dane_4plus_Wiadomosci_liczba_ts
plot( dane_4plus_Wiadomosci_liczba_ts)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(
ts(
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr],
start = c(2013,7), frequency = 12
)
)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(
ts(
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )[filtr]+
dane_4plus_Wiadomosci_liczba_ts_sezonowosc[filtr]+
dane_4plus_Wiadomosci_liczba_ts_random[filtr],
start = c(2013,7), frequency = 12
), col="red"
)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"]+
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["seasonal"]+
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["random"]
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")["trend"]
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]]+
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]+
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]]+
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]+
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]]
)
plot( dane_4plus_Wiadomosci_liczba_ts,   ylab="liczba widzów", xlab="data")
lines(
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["trend"]]+
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]+
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["random"]],
col="red"
)
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
dane_4plus_Wiadomosci_liczba_ts_sezonowosc
t(matrix(data = dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), nrow = 12))
dane_4plus_Wiadomosci_liczba_ts
ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
colMeans( dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ), na.rm = T)
colMeans( as.matrix( dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) ), na.rm = T)
as.matrix( dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
matrix( dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
class(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
colMeans(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
colMeans(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
matrix(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) ,nrow = 12)
matrix(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) ,nrow = 4)
matrix(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 )
(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )["Jan"]
(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )$Jan
summary(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) ))
summary(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
data.frame(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
(dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )
tapply((dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) ), cycle((dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )), FUN=mean
tapply((dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) ), cycle((dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )), FUN=mean)
tapply((dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) ), cycle((dane_4plus_Wiadomosci_liczba_ts-ma( dane_4plus_Wiadomosci_liczba_ts, order = 12 ) )), FUN=mean, na.rm=TRUE)
decompose( dane_4plus_Wiadomosci_liczba_ts, type ="additive")[["seasonal"]]
